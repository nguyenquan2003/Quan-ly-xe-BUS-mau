using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace GPSDemo
{
    public partial class Form1 : Form
    {
        List<string> StrList;
        public Form1()
        {
            InitializeComponent();
            StrList = new List<string>()
{"20.980623,105.841322",
"20.980803,105.841333",
"20.980833,105.841161",
"20.980914,105.84107",
"20.981019,105.841075",
"20.981119,105.841081",
"20.981244,105.841054",
"20.981339,105.841075",
"20.981434,105.841092",
"20.981555,105.841086",
"20.98165,105.841059",
"20.981785,105.841065",
"20.98192,105.84107",
"20.982056,105.841075",
"20.982191,105.841081",
"20.982326,105.841086",
"20.982429,105.84109",
"20.98255,105.841095",
"20.982617,105.841097",
"20.982752,105.841102",
"20.982887,105.841108",
"20.983248,105.841097",
"20.983301,105.84109",
"20.983423,105.841113",
"20.983573,105.841129",
"20.983708,105.841113",
"20.983824,105.841097",
"20.983934,105.841097",
"20.984034,105.841097",
"20.984134,105.841097",
"20.984234,105.841113",
"20.98433,105.841129",
"20.98444,105.841129",
"20.98455,105.841129",
"20.98466,105.841124",
"20.98477,105.841108",
"20.984871,105.84113",
"20.984991,105.841102",
"20.985101,105.841113",
"20.985206,105.841124",
"20.985311,105.841134",
"20.985416,105.841145",
"20.985517,105.841145",
"20.985622,105.841145",
"20.985727,105.841129",
"20.985842,105.84114",
"20.985957,105.841151",
"20.986022,105.841129",
"20.986198,105.84114",
"20.986273,105.84114",
"20.986398,105.841145",
"20.986523,105.841151",
"20.986649,105.841156",
"20.986774,105.841161",
"20.986899,105.841167",
"20.987024,105.841172",
"20.987149,105.841177",
"20.987265,105.841177",
"20.987365,105.841167",
"20.987495,105.841183",
"20.98761,105.841183",
"20.987725,105.841177",
"20.987836,105.841172",
"20.987936,105.841188",
"20.988071,105.841188",
"20.988181,105.841188",
"20.988336,105.841177",
"20.988492,105.841183",
"20.988617,105.841188",
"20.988737,105.841193",
"20.988857,105.841199",
"20.988977,105.841204",
"20.989083,105.84121",
"20.989183,105.84121",
"20.989253,105.841204",
"20.989323,105.84122",
"20.989474,105.841203",
"20.989558,105.841199",
"20.989669,105.841199",
"20.989759,105.841199",
"20.989874,105.84121",
"20.989949,105.84122",
"20.990019,105.841231",
"20.990089,105.841231",
"20.990159,105.84122",
"20.99023,105.841236",
"20.990335,105.841231",
"20.990435,105.841226",
"20.99054,105.84122",
"20.99065,105.841226",
"20.990755,105.841236",
"20.990866,105.841247",
"20.990991,105.841247",
"20.991106,105.841247",
"20.991201,105.841236",
"20.991306,105.841236",
"20.991422,105.841253",
"20.991482,105.841253",
"20.991542,105.841253",
"20.991587,105.841253",
"20.991632,105.841253",
"20.991672,105.841253",
"20.991712,105.841253",
"20.991767,105.841253",
"20.991842,105.841253",
"20.991917,105.841253",
"20.991993,105.841253",
"20.992068,105.841253",
"20.992143,105.841253",
"20.992218,105.841253",
"20.992293,105.841247",
"20.992368,105.841242",
"20.992443,105.841236",
"20.992518,105.841231",
"20.992594,105.841242",
"20.992669,105.841253",
"20.992744,105.841258",
"20.992819,105.841263",
"20.992894,105.841317",
"20.992969,105.841371",
"20.993044,105.841424",
"20.993119,105.841478",
"20.993195,105.841526",
"20.99327,105.841574",
"20.99334,105.841623",
"20.99341,105.841671",
"20.993475,105.841719",
"20.99354,105.841767",
"20.9936,105.841805",
"20.99366,105.841837",
"20.99371,105.841864",
"20.993796,105.841924",
"20.993876,105.841977",
"20.993961,105.842046",
"20.994046,105.8421",
"20.994131,105.842148",
"20.994206,105.842197",
"20.994276,105.842234",
"20.994346,105.842272",
"20.994417,105.842309",
"20.994482,105.842347",
"20.994542,105.842374",
"20.994602,105.842395",
"20.994687,105.842438",
"20.994772,105.842486",
"20.994842,105.842535",
"20.994902,105.842583",
"20.994962,105.842626",
"20.995023,105.842669",
"20.995088,105.842706",
"20.995183,105.842738",
"20.995273,105.842771",
"20.995363,105.842803",
"20.995453,105.842819",
"20.995528,105.842835",
"20.995604,105.842851",
"20.995679,105.842862",
"20.995754,105.842862",
"20.995829,105.842856",
"20.995904,105.842851",
"20.995979,105.842846",
"20.996054,105.84284",
"20.996129,105.842835",
"20.996205,105.84283",
"20.99628,105.842824",
"20.996355,105.842819",
"20.99643,105.842814",
"20.996505,105.842808",
"20.99658,105.842803",
"20.996655,105.842797",
"20.99673,105.842792",
"20.996806,105.842781",
"20.996866,105.842771",
"20.996921,105.84276",
"20.996976,105.842749",
"20.997051,105.842749",
"20.997116,105.842749",
"20.997226,105.842733",
"20.997286,105.842715",
"20.997296,105.842637",
"20.997311,105.84254",
"20.997326,105.842443",
"20.997341,105.842352",
"20.997356,105.842261",
"20.997371,105.842175",
"20.997386,105.8421",
"20.997402,105.842025",
"20.997417,105.841955",
"20.997432,105.841891",
"20.997432,105.841816",
"20.997447,105.841757",
"20.997472,105.841676",
"20.997502,105.841607",
"20.997522,105.841515",
"20.997542,105.841424",
"20.997577,105.841344",
"20.997607,105.841274",
"20.997632,105.841215",
};
        }

        Timer timer = new Timer();
        int i = 0;
        private void button1_Click(object sender, EventArgs e)
        {

            timer.Tick += new EventHandler(getData);
            //timer.Tick += new EventHandler(tick);
            timer.Start();
            
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            timer.Interval = 1000;
        }

      public void getData(object source, EventArgs e)
{
    if (i >= StrList.Count)
    {
        // Optional: Stop the timer if the end of the list is reached
        timer.Stop();
        label1.Text = "Đã đến cuối danh sách";
        return;
    }

    SqlParameter[] param = new SqlParameter[5];
    param[0] = new SqlParameter("@Drive", SqlDbType.Int);
    param[0].Value = 1;

    param[1] = new SqlParameter("@Time", SqlDbType.DateTime);
    param[1].Value = DateTime.Now;

    param[2] = new SqlParameter("@Latitude", SqlDbType.Float);
    param[2].Value = Convert.ToDecimal(StrList[i].Split(',')[0]);

    param[3] = new SqlParameter("@Longitude", SqlDbType.Float);
    param[3].Value = Convert.ToDecimal(StrList[i].Split(',')[1]);

    param[4] = new SqlParameter("@Speed", SqlDbType.Float);
    param[4].Value = 30;

    SQLDataAccess.Execute("sp_InsertGPS", param);
    label1.Text = "Cập nhật Thành công " + i.ToString() + " - " + param[1].Value;
    i++;
}


        public void tick(object source, EventArgs e)
        {
            label1.Text = DateTime.Now.ToString();
            label2.Text = DateTime.Now.ToLocalTime().ToString();
        }
    }
}
